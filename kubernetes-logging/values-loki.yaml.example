deploymentMode: SingleBinary

global:
  image:
    registry: docker.io


canary:
  enabled: false
chunksCache:
  enabled: false
resultsCache:
  enabled: false


gateway:
  enabled: true
  image:
    registry: docker.io
    repository: nginxinc/nginx-unprivileged
  nodeSelector:
    node-role: "infra"
  tolerations:
    - key: "node-role"
      operator: "Equal"
      value: "infra"
      effect: "NoSchedule"


nodeSelector:
  node-role: "infra"
tolerations:
  - key: "node-role"
    operator: "Equal"
    value: "infra"
    effect: "NoSchedule"


podSecurityContext:
  fsGroup: 10001

loki:
  image:
    registry: docker.io
    repository: grafana/loki
    tag: "3.5.3"


  sidecar:
    enabled: false

  auth_enabled: false

  commonConfig:
    replication_factor: 1

  # Хранилище YC S3
  storage:
    type: s3
    bucketNames:
      chunks: otus-loki-logs-dm1
      ruler:  otus-loki-logs-dm1
      admin:  otus-loki-logs-dm1
    s3:
      endpoint: https://storage.yandexcloud.net
      region: ru-central1
      accessKeyId: 1233456612
      secretAccessKey: 122345
      s3ForcePathStyle: true
      insecure: false

  schemaConfig:
    configs:
      - from: "2025-01-01"
        store: boltdb-shipper
        object_store: s3
        schema: v13
        index:
          prefix: loki_index_
          period: 24h


  limits_config:
    allow_structured_metadata: false

persistence:
  enabled: true
  size: 10Gi
  accessModes: ["ReadWriteOnce"]
  storageClassName: yc-network-hdd

resources:
  requests:
    cpu: "200m"
    memory: "512Mi"
  limits:
    cpu: "1000m"
    memory: "2Gi"
